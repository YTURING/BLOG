---
title: Lenovo 小新Pro13 VMware workstation虚拟机安装黑苹果
date: 2020-05-08 15:58:37
categories:
- [Windows]
tags:
- [虚拟机]
- [MacOS]
---

听说AMD上装黑苹果不好装，结果就试了一把，把我的安装步骤分享给大家，顺便说一句，Mac体验真的爽。  
环境：联想小Pro13(就是那个年度真香机)，CPU：AMD Ryzen 5 3550H(各种问题主要是出在这里，人家Intel就很稳)，VMware Workstation [15.1.0](https://download3.vmware.com/software/wkst/file/VMware-workstation-full-15.1.0-13591040.exe)(注意软件版本，太新了也安装不上)，目标系统：MacOS 10.12、10.13。至于安装镜像，第一次安装的话，可以用别人制作好的iso镜像，以后熟了可以自己用黑苹果把dmg转为iso。  
###安装unlocker  
VMware Workstation 低版本不支持直接安装MacOS(据说高版本可以，我没试过)，所以需要给VMware打个补丁。可以在[Github](https://github.com/paolo-projects/unlocker/releases)上下载，下载好后解压到随便哪个目录，然后右键"以管理员身份运行" win-install.cmd,等待它安装成功即可，在这过程中它会下载个文件，可能你需要使用代理才会下载地快些。  
![unlocker安装](/images/20200507185913.png)  
###安装虚拟机  
1.打开VMware workstation,自定义安装，选择下载好的镜像，选择客户机操作系统(Apple Mac OSX(M)),版本就根据你下载的镜像选择，我安装的是10.12和10.13。接下来是填写虚拟机名称，选择虚拟机文件的存放位置。处理器和内存根据自己的电脑配置选择合适的量。网络连接随便选，有兴趣可以下去了解一下桥接和NAT，我这里选择的是NAT，虚拟机可以直接上网，桥接也可以。仅主机模式也可以，不过要在适配器属性里设置一下分享。然后剩下的默认就行。  
![选择镜像](/images/20200507190105.png)  
![选择系统](/images/20200507190127.png)  
![命名及位置](/images/20200507190248.png)  
![处理器](/images/20200507190316.png)  
![内存](/images/20200507190333.png)  
![网络](/images/20200507190355.png)  
![SCSI控制器](/images/20200507190408.png)  
![磁盘类型](/images/20200507190423.png)  
![磁盘](/images/20200507190439.png)  
2.打开虚拟机文件存放的目录，打开.vmx文件，加入以下内容，否则开启虚拟机会提示客户机操作系统已禁用CPU。注意要加的位置是`smc.present = "TRUE"`下面。最后两行keyboard和mouse是为了在安装MacOS时让鼠标可以动，不设置是动不了的。最后还要把顶部第三行virtualHW.version = "16"中的，16改为10，然后存文件。然后开启虚拟机，如果提示 该虚拟机要求使用AVX2,但AVX不存在 ，请检查把16改为10改好了没，如果改好了，虚拟机详细信息那里会显示 硬件兼容性：Workstation 10.x虚拟机 。如果是没生效可以试试退出VMware workstation重新打开试试。  

```Bash
smc.version = "0"
cpuid.0.eax = "0000:0000:0000:0000:0000:0000:0000:1011"
cpuid.0.ebx = "0111:0101:0110:1110:0110:0101:0100:0111"
cpuid.0.ecx = "0110:1100:0110:0101:0111:0100:0110:1110"
cpuid.0.edx = "0100:1001:0110:0101:0110:1110:0110:1001"
cpuid.1.eax = "0000:0000:0000:0001:0000:0110:0111:0001"
cpuid.1.ebx = "0000:0010:0000:0001:0000:1000:0000:0000"
cpuid.1.ecx = "1000:0010:1001:1000:0010:0010:0000:0011"
cpuid.1.edx = "0000:1111:1010:1011:1111:1011:1111:1111"
featureCompat.enable = "FALSE"
keyboard.vusb.enable = "TRUE"
mouse.vusb.enable = "TRUE"
```
![客户机系统已禁用CPU](/images/20200507190704.png)  
![vmx](/images/20200507190813.png)  
![修改vmx](/images/20200507191025.png)  
![鼠标](/images/20200507191257.png)  
![vmx](/images/20200507191500.png)  
![vmx](/images/20200507191602.png)  
![虚拟机详细信息](/images/20200507193135.png)  
3.打开虚拟机后，看到苹果图标等进度条走完，进入到选择语言界面，你会发现鼠标还是不能动，关闭虚拟机，点击编辑虚拟机设置，在USB控制器那里把USB兼容性1.1改为2.0，你可能会问为什么不一开始就选择，这是因为这个1.1是在打开虚拟机进入到语言选择界面才变的。  
![选择语言](/images/20200507193051.png)  
![USB](/images/20200507193205.png)  
![USB](/images/20200507193230.png)  
4. 然后就进入到安装系统界面，点击顶栏的磁盘工具，选择左侧虚拟磁盘，抹掉，名称随意，方案选主引导记录和GUID分区图都行。然后点击顶部终端，在终端里输入`csrutil disable`,然后`csrutil status`查看状态，这是为了安装VMware tools后可以全屏。[具体参考](https://www.jianshu.com/p/d7d4d7ba95a3),接下来选择刚才抹掉的磁盘，安装系统，等进度条走完就好了。  
![磁盘工具](/images/20200507194010.png)  
![抹掉磁盘](/images/20200507194128.png)  
![终端](/images/20200507194224.png)  
![选择磁盘](/images/20200507194434.png)  
![安装系统](/images/20200507194525.png)  

